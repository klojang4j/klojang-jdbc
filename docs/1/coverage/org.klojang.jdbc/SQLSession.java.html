<?xml version="1.0" encoding="UTF-8"?><!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd"><html xmlns="http://www.w3.org/1999/xhtml" lang="en"><head><meta http-equiv="Content-Type" content="text/html;charset=UTF-8"/><link rel="stylesheet" href="../jacoco-resources/report.css" type="text/css"/><link rel="shortcut icon" href="../jacoco-resources/report.gif" type="image/gif"/><title>SQLSession.java</title><link rel="stylesheet" href="../jacoco-resources/prettify.css" type="text/css"/><script type="text/javascript" src="../jacoco-resources/prettify.js"></script></head><body onload="window['PR_TAB_WIDTH']=4;prettyPrint()"><div class="breadcrumb" id="breadcrumb"><span class="info"><a href="../jacoco-sessions.html" class="el_session">Sessions</a></span><a href="../index.html" class="el_report">Klojang JDBC</a> &gt; <a href="index.source.html" class="el_package">org.klojang.jdbc</a> &gt; <span class="el_source">SQLSession.java</span></div><h1>SQLSession.java</h1><pre class="source lang-java linenums">package org.klojang.jdbc;

/**
 * &lt;p&gt;An {@code SQLSession} is used to initiate and partly prepare the execution of SQL.
 * It allows the user to set SQL &lt;i&gt;template variables&lt;/i&gt; within the SQL and then obtain
 * a {@link SQLStatement} object that can be used to set (a.k.a. &quot;bind&quot;) the &lt;i&gt;named
 * parameters&lt;/i&gt; within the SQL. The difference between template variables and named
 * parameters is explained in the comments for the {@link SQL} interface. Note that one of
 * the implementations of {@code SQLSession} (the one you get from
 * {@link SQL#basic(String) SQL.basic()}) does not support template variables and
 * therefore calls to its {@link #set(String, Object) set()} method will throw an
 * {@link UnsupportedOperationException}.
 *
 * &lt;p&gt;Probably the most common use case for using template variables is to parametrize
 * the ORDER BY column and sort order (&quot;ASC&quot; or &quot;DESC&quot;). Therefore the {@code SQLSession}
 * contains a few specialized {@code set} methods specifically for this purpose. These
 * methods assume that the SQL template contains a template variable named &quot;sortColumn&quot;
 * for the ORDER BY column(s), and a template variable name &quot;sortOrder&quot; for the sort
 * order.
 *
 * &lt;p&gt;&lt;i&gt;An {@code SQLSession} is not thread-safe and should generally not be reused once
 * you have obtained a {@code SQLStatement} object from it.&lt;/i&gt;
 */

/*
 * In fact all implementations currently _are_ thread-safe, but they are not intended to
 * be, and we don't want to commit to it.
 */
public sealed interface SQLSession permits AbstractSQLSession {

  /**
   * Sets the value of a template variable. This method will throw an
   * {@link UnsupportedOperationException} for
   * {@linkplain SQL#basic(String) basic SQL sessions} since these are not based on &lt;a
   * href=&quot;https://klojang4j.github.io/klojang-templates/1/api/org.klojang.templates/module-summary.html&quot;&gt;Klojang
   * Templates&lt;/a&gt;.
   *
   * @param varName the name of the template variable
   * @param value the value to set the variable to. If the value is an array or
   * collection, it will be &quot;imploded&quot; to a string, using {@code &quot;,&quot; } (comma) to separate
   * the elements in the array or collection.
   * @return this {@code SQLSession} instance
   * @throws UnsupportedOperationException in case this {@code SQLSession} was obtained
   * via the {@link SQL#basic(String) SQL.basic()} method
   * @see org.klojang.templates.Template
   * @see org.klojang.templates.RenderSession#set(String, Object)
   */
  default SQLSession set(String varName, Object value)
        throws UnsupportedOperationException {
<span class="nc" id="L50">    throw new UnsupportedOperationException();</span>
  }


  /**
   * Sets a template variable name &quot;sortColumn&quot; to the specified value. This presumes and
   * requires that the SQL template indeed contains a variable with that name. This is a
   * convenience method facilitating the most common use case for template variables: to
   * parametrize the column(s) in the ORDER BY clause.
   *
   * @param sortColumn the column(s) to sort on
   * @return this {@code SQLSession} instance
   * @throws UnsupportedOperationException in case this {@code SQLSession} was obtained
   * via the {@link SQL#basic(String) SQL.basic()} method
   */
  default SQLSession setOrderBy(Object sortColumn) throws UnsupportedOperationException {
<span class="nc" id="L66">    return set(&quot;sortColumn&quot;, sortColumn);</span>
  }

  /**
   * Sets a template variable name &quot;sortOrder&quot; to the specified value. This presumes and
   * requires that the SQL template indeed contains a variable with that name. The
   * provided value supposedly is either &quot;ASC&quot; or &quot;DESC&quot;. The value may also be a boolean,
   * in which case {@code true} is translated into &quot;DESC&quot; and {@code false} into &quot;ASC&quot;.
   * This is a convenience method facilitating the most common use case for template
   * variables: to parametrize the sort order for the column(s) in the ORDER BY clause.
   *
   * @param sortOrder the sort order
   * @return this {@code SQLSession} instance
   * @throws UnsupportedOperationException in case this {@code SQLSession} was obtained
   * via the {@link SQL#basic(String) SQL.basic()} method
   */
  default SQLSession setSortOrder(Object sortOrder) throws UnsupportedOperationException {
<span class="nc bnc" id="L83" title="All 2 branches missed.">    return (sortOrder instanceof Boolean)</span>
<span class="nc" id="L84">          ? setDescending((Boolean) sortOrder)</span>
<span class="nc" id="L85">          : set(&quot;sortOrder&quot;, sortOrder);</span>
  }

  /**
   * Sets a template variable name &quot;sortOrder&quot; to &quot;DESC&quot; if the argument equals
   * {@code true}, else to &quot;ASC&quot;.
   *
   * @param isDescending whether to sort in descending order
   * @return this {@code SQLSession} instance
   * @throws UnsupportedOperationException in case this {@code SQLSession} was obtained
   * via the {@link SQL#basic(String) SQL.basic()} method
   */
  default SQLSession setDescending(boolean isDescending)
        throws UnsupportedOperationException {
<span class="nc bnc" id="L99" title="All 2 branches missed.">    return set(&quot;sortOrder&quot;, isDescending ? &quot;DESC&quot; : &quot;ASC&quot;);</span>
  }

  /**
   * Sets the sort column and sort order of an ORDER BY clause.
   *
   * @param sortColumn the column to sort on
   * @param sortOrder the sort order
   * @return this {@code SQLSession} instance
   * @throws UnsupportedOperationException in case this {@code SQLSession} was obtained
   * via the {@link SQL#basic(String) SQL.basic()} method
   */
  default SQLSession setOrderBy(Object sortColumn, Object sortOrder)
        throws UnsupportedOperationException {
<span class="nc" id="L113">    return setOrderBy(sortColumn).setSortOrder(sortOrder);</span>
  }

  /**
   * Sets the ort column and sort order of an ORDER BY clause.
   *
   * @param sortColumn the column to sort on
   * @param isDescending whether to sort in descending order
   * @return this {@code SQLSession} instance
   * @throws UnsupportedOperationException in case this {@code SQLSession} was obtained
   * via the {@link SQL#basic(String) SQL.basic()} method
   */
  default SQLSession setOrderBy(Object sortColumn, boolean isDescending)
        throws UnsupportedOperationException {
<span class="nc" id="L127">    return setOrderBy(sortColumn).setDescending(isDescending);</span>
  }

  /**
   * Returns a {@code SQLQuery} instance that allows you to provide values for named
   * parameters (&quot;binding&quot;) and then execute the query.
   *
   * @return a {@code SQLQuery} instance
   */
  SQLQuery prepareQuery();

  /**
   * Returns a {@code SQLInsert} instance that allows you to provide values for named
   * parameters (&quot;binding&quot;) and then execute the INSERT statement. Auto-generated keys
   * will be made available to the client.
   *
   * @return a {@code SQLInsert} instance
   */
  default SQLInsert prepareInsert() {
<span class="fc" id="L146">    return prepareInsert(true);</span>
  }

  /**
   * Returns a {@code SQLInsert} instance that allows you to provide values for named
   * parameters (&quot;binding&quot;) and then execute the INSERT statement.
   *
   * @param retrieveAutoKeys whether to retrieve the keys that were generated by the
   * database
   * @return a {@code SQLInsert} instance
   */
  SQLInsert prepareInsert(boolean retrieveAutoKeys);

  /**
   * Returns a {@code SQLUpdate} instance that allows you to provide values for named
   * parameters (&quot;binding&quot;) and then execute the UPDATE or DELETE statement.
   *
   * @return a {@code SQLUpdate} instance
   */
  SQLUpdate prepareUpdate();

}
</pre><div class="footer"><span class="right">Created with <a href="http://www.jacoco.org/jacoco">JaCoCo</a> 0.8.8.202204050719</span></div></body></html>