<?xml version="1.0" encoding="UTF-8"?><!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd"><html xmlns="http://www.w3.org/1999/xhtml" lang="en"><head><meta http-equiv="Content-Type" content="text/html;charset=UTF-8"/><link rel="stylesheet" href="../jacoco-resources/report.css" type="text/css"/><link rel="shortcut icon" href="../jacoco-resources/report.gif" type="image/gif"/><title>BeanExtractor.java</title><link rel="stylesheet" href="../jacoco-resources/prettify.css" type="text/css"/><script type="text/javascript" src="../jacoco-resources/prettify.js"></script></head><body onload="window['PR_TAB_WIDTH']=4;prettyPrint()"><div class="breadcrumb" id="breadcrumb"><span class="info"><a href="../jacoco-sessions.html" class="el_session">Sessions</a></span><a href="../index.html" class="el_report">Klojang JDBC</a> &gt; <a href="index.source.html" class="el_package">org.klojang.jdbc</a> &gt; <span class="el_source">BeanExtractor.java</span></div><h1>BeanExtractor.java</h1><pre class="source lang-java linenums">package org.klojang.jdbc;

import java.sql.ResultSet;
import java.util.List;
import java.util.Optional;

/**
 * &lt;p&gt;Converts the rows in a JDBC {@link ResultSet} into JavaBeans, records or
 * {@code Map&lt;String, Object&gt;} pseudo-objects. For brevity's sake we will call all three
 * types of objects &quot;beans&quot; from now on. Instances of this interface are obtained via
 * {@link BeanExtractorFactory#getExtractor(ResultSet)
 * BeanExtractorFactory.getExtractor()} or via
 * {@link MapExtractorFactory#getExtractor(ResultSet) MapExtractorFactory.getExtractor()}.
 * A {@code BeanExtractor} is agnostic about, and has no opinion on how the
 * {@link ResultSet} was obtained. It may have been produced using regular JDBC calls. It
 * does not aim to be an ORM-like class. It just converts result sets into (flat) beans,
 * to be carried across the boundary of the data access module (and into the view layer,
 * for example). The beans may have nested structures, but only top-level properties will
 * be populated.
 *
 * &lt;p&gt;{@code BeanExtractor} is an extension of the {@link Iterable} interface,
 * enabling you to extract the beans in a {@code forEach} loop:
 *
 * &lt;blockquote&gt;&lt;pre&gt;{@code
 * static final BeanExtractorFactory FACTORY = new BeanExtractorFactory(Employee.class);
 *
 * // ...
 *
 * try(ResultSet rs = ...) {
 *   for(Employee emp : FACTORY.getExtractor(rs)) {
 *     // do stuff ...
 *   }
 * }
 * }&lt;/pre&gt;&lt;/blockquote&gt;
 *
 * &lt;h2&gt;JavaBeans vs. Records&lt;/h2&gt;
 * When converting a row into a JavaBean, a {@code BeanExtractor} will always use the
 * setters on the JavaBean to populate it. There is no way to populate a JavaBean via its
 * constructors. When converting to a {@code record}, a {@code BeanExtractor} will
 * obviously always use one of its constructors to populate it. Make sure the record has a
 * constructor for those record components that are supposed to map to columns in the
 * SELECT clause. The encounter order of the record components within the constructor must
 * match the encounter order of the columns in the SELECT clause. However, it is not
 * necessary that each record component can be mapped to a column in the SELECT clause,
 * and it is not necessary that each column in the SELECT clause can be mapped back to a
 * record component.
 *
 * &lt;h2&gt;Map Extractors&lt;/h2&gt;
 *
 * Although the {@code BeanExtractor} interface also allows for the extraction of
 * {@code Map&lt;String, Object&gt;} pseudo-objects from a {@code ResultSet}, there still is a
 * specialization of the {@code BeanExtractor} interface specifically for this purpose:
 * the {@link MapExtractor} interface. This interface does not contain any methods, but it
 * reduces the verbosity of your code and, more importantly, it reflects the fact that map
 * extractors are configured and obtained by other means than JavaBean and {@code record}
 * extractors &amp;#8212; respectively through a {@link MapExtractorFactory} and a
 * {@link BeanExtractorFactory}.
 *
 * @param &lt;T&gt; the type of the beans produced by the {@code BeanExtractor}
 * @author Ayco Holleman
 * @see BeanExtractorFactory
 * @see MapExtractor
 */
public sealed interface BeanExtractor&lt;T&gt; extends Iterable&lt;T&gt;
      permits MapExtractor, AbstractBeanExtractor {

  /**
   * Converts the current row within the {@code ResultSet} into a bean. If the
   * {@code ResultSet} is empty, or if there are no more rows in the {@code ResultSet}, an
   * empty {@code Optional} is returned. You can keep calling {@code extract()} to
   * successively extract all rows in the result set until you receive an empty
   * {@code Optional}, or until {@link #isEmpty()} returns {@code true}.
   *
   * @return an {@code Optional} containing the bean or an empty {@code Optional} if the
   *       {@code ResultSet} contained no (more) rows
   */
  Optional&lt;T&gt; extract();

  /**
   * Converts at most {@code limit} rows from the {@code ResultSet} into beans, possibly
   * less, if there are not that many rows left in the {@code ResultSet}. If the
   * {@code ResultSet} is empty, or if there are no more rows in the {@code ResultSet}, an
   * empty {@code List} is returned.
   *
   * @param limit the maximum number of rows to extract and convert
   * @return a {@code List} of beans or an empty {@code List} if the {@code ResultSet}
   *       contained no (more) rows
   */
  List&lt;T&gt; extract(int limit);

  /**
   * Converts all remaining rows in the {@code ResultSet} into beans. Equivalent to
   * {@link #extractAll(int) extractAll(10)}.
   *
   * @return a {@code List} of beans or an empty {@code List} if the {@code ResultSet}
   *       contained no (more) rows
   */
<span class="fc" id="L98">  default List&lt;T&gt; extractAll() { return extractAll(10); }</span>

  /**
   * Converts all remaining rows in the {@code ResultSet} into beans.
   *
   * @param sizeEstimate an estimate of the size of the resulting {@code List}.
   * @return a {@code List} of beans or an empty {@code List} if the {@code ResultSet}
   *       contained no (more) rows
   */
  List&lt;T&gt; extractAll(int sizeEstimate);

  /**
   * Returns {@code true} if the end of the {@code ResultSet} has been reached;
   * {@code false} otherwise.
   *
   * @return whether the end of the {@code ResultSet} has been reached
   */
  boolean isEmpty();

}
</pre><div class="footer"><span class="right">Created with <a href="http://www.jacoco.org/jacoco">JaCoCo</a> 0.8.11.202310140853</span></div></body></html>